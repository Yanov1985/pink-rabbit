<template>
  <!-- –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞—Ç–∞–ª–æ–≥–∞ —Å Schema.org —Ä–∞–∑–º–µ—Ç–∫–æ–π -->
  <header
    ref="headerRef"
    class="catalog-header catalog-header-sticky"
    role="banner"
    aria-label="–ó–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞—Ç–∞–ª–æ–≥–∞ —Ç–æ–≤–∞—Ä–æ–≤"
    itemscope
    itemtype="https://schema.org/WebPageElement"
  >
    <!-- Skeleton —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ -->
    <section
      v-if="isLoading"
      class="pink-rabbit-header-skeleton"
      role="status"
      aria-label="–ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞—Ç–∞–ª–æ–≥–∞"
      aria-live="polite"
    >
      <div class="skeleton-content">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ skeleton -->
        <div
          class="skeleton-title"
          aria-label="–ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"
        ></div>
        <!-- –°—á–µ—Ç—á–∏–∫ —Ç–æ–≤–∞—Ä–æ–≤ skeleton -->
        <div
          class="skeleton-counter"
          aria-label="–ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å—á–µ—Ç—á–∏–∫ —Ç–æ–≤–∞—Ä–æ–≤"
        ></div>
      </div>

      <!-- –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è skeleton -->
      <div class="skeleton-controls">
        <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤–∏–¥–æ–≤ skeleton -->
        <div
          class="skeleton-view-toggle"
          aria-label="–ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤–∏–¥–æ–≤"
        >
          <div class="skeleton-view-btn"></div>
          <div class="skeleton-view-btn"></div>
        </div>
        <!-- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ skeleton -->
        <div
          class="skeleton-sort-dropdown"
          aria-label="–ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —ç–ª–µ–º–µ–Ω—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏"
        ></div>
      </div>
    </section>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–∑–º–µ—Ç–∫–æ–π -->
    <section
      v-else
      class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"
      role="main"
      aria-label="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–æ–º —Ç–æ–≤–∞—Ä–æ–≤"
    >
      <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞—Ç–∞–ª–æ–≥–µ -->
      <section
        class="catalog-info"
        role="region"
        aria-labelledby="catalog-title"
        itemscope
        itemtype="https://schema.org/CollectionPage"
      >
        <h1
          id="catalog-title"
          class="text-2xl font-bold text-gray-900 catalog-title"
          itemprop="name"
          role="heading"
          aria-level="1"
        >
          {{ categoryTitle }}
        </h1>
        <p
          class="text-gray-600 mt-1 catalog-count"
          itemprop="description"
          role="status"
          aria-live="polite"
          :aria-label="`–ù–∞–π–¥–µ–Ω–æ ${totalCount} ${getProductsWord(
            totalCount
          )} –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ${categoryTitle}`"
        >
          –ù–∞–π–¥–µ–Ω–æ {{ totalCount }}
          {{ getProductsWord(totalCount) }}
        </p>

        <!-- –°–∫—Ä—ã—Ç–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º -->
        <meta itemprop="numberOfItems" :content="totalCount" />
        <meta
          itemprop="itemListOrder"
          content="https://schema.org/ItemListOrderAscending"
        />
      </section>

      <!-- –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ç–∞–ª–æ–≥–æ–º -->
      <nav
        class="flex items-center gap-4 catalog-controls"
        role="navigation"
        aria-label="–≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ç–∞–ª–æ–≥–æ–º"
        itemscope
        itemtype="https://schema.org/SiteNavigationElement"
      >
        <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤–∏–¥–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
        <fieldset
          class="flex bg-gray-100 rounded-lg p-1"
          ref="viewToggleRef"
          role="radiogroup"
          aria-label="–í—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤"
          aria-describedby="view-mode-description"
        >
          <legend class="sr-only">–†–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤</legend>
          <span id="view-mode-description" class="sr-only">
            –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞–∫ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Ç–æ–≤–∞—Ä—ã: –≤ 4 –∫–æ–ª–æ–Ω–∫–∏ –∫–∞–∫ –≤–∏—Ç—Ä–∏–Ω–∞ —Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç–∞
            –∏–ª–∏ –≤ 3 –∫–æ–ª–æ–Ω–∫–∏ –∫–∞–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–µ
          </span>

          <button
            @click="$emit('changeViewMode', 4)"
            :class="[
              'px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 view-toggle-button',
              viewMode === 4
                ? 'view-active text-white shadow-sm active'
                : 'text-gray-600 hover:text-gray-900',
            ]"
            title="4 –∫–æ–ª–æ–Ω–∫–∏ - –∫–∞–∫ –≤–∏—Ç—Ä–∏–Ω–∞ —Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç–∞"
            :disabled="isLoading"
            role="radio"
            :aria-checked="viewMode === 4"
            aria-label="–û—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Ç–æ–≤–∞—Ä—ã –≤ 4 –∫–æ–ª–æ–Ω–∫–∏"
            :aria-pressed="viewMode === 4"
          >
            <!-- –ò–∫–æ–Ω–∫–∞ 4 –∫–æ–ª–æ–Ω–∫–∏ —Å Heroicons -->
            <Squares2X2Icon
              class="w-5 h-5"
              aria-hidden="true"
              role="img"
              aria-label="–ò–∫–æ–Ω–∫–∞ —Å–µ—Ç–∫–∏ 4 –∫–æ–ª–æ–Ω–∫–∏"
            />
          </button>
          <button
            @click="$emit('changeViewMode', 3)"
            :class="[
              'px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 view-toggle-button',
              viewMode === 3
                ? 'view-active text-white shadow-sm active'
                : 'text-gray-600 hover:text-gray-900',
            ]"
            title="3 –∫–æ–ª–æ–Ω–∫–∏ - –∫–∞–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–µ"
            :disabled="isLoading"
            role="radio"
            :aria-checked="viewMode === 3"
            aria-label="–û—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Ç–æ–≤–∞—Ä—ã –≤ 3 –∫–æ–ª–æ–Ω–∫–∏"
            :aria-pressed="viewMode === 3"
          >
            <!-- –ò–∫–æ–Ω–∫–∞ 3 –∫–æ–ª–æ–Ω–∫–∏ —Å Heroicons -->
            <ViewColumnsIcon
              class="w-5 h-5"
              aria-hidden="true"
              role="img"
              aria-label="–ò–∫–æ–Ω–∫–∞ —Å–µ—Ç–∫–∏ 3 –∫–æ–ª–æ–Ω–∫–∏"
            />
          </button>
        </fieldset>

        <!-- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–∑–º–µ—Ç–∫–æ–π -->
        <div
          class="relative sort-wrapper"
          role="region"
          aria-label="–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤"
          itemscope
          itemtype="https://schema.org/SortAction"
        >
          <label for="sort-select" class="sr-only">
            –í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
          </label>
          <select
            id="sort-select"
            :value="sortBy"
            @change="$emit('changeSorting', $event.target.value)"
            class="px-4 py-2 pl-10 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-custom-pink focus:border-custom-pink sort-select appearance-none"
            ref="sortRef"
            :disabled="isLoading"
            role="combobox"
            aria-label="–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤"
            aria-describedby="sort-description"
            :aria-expanded="false"
            itemprop="name"
          >
            <option value="popularity">–ü–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏</option>
            <option value="price-asc">–¶–µ–Ω–∞: –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</option>
            <option value="price-desc">–¶–µ–Ω–∞: –ø–æ —É–±—ã–≤–∞–Ω–∏—é</option>
            <option value="rating">–ü–æ —Ä–µ–π—Ç–∏–Ω–≥—É</option>
            <option value="newest">–°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ</option>
          </select>

          <span id="sort-description" class="sr-only">
            –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã: –ø–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –∫–∞–∫ –≤ Tinder, –ø–æ
            —Ü–µ–Ω–µ, —Ä–µ–π—Ç–∏–Ω–≥—É –∏–ª–∏ –Ω–æ–≤–∏–∑–Ω–µ
          </span>

          <!-- –ò–∫–æ–Ω–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Å Heroicons - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ -->
          <div
            class="absolute left-3 top-1/2 transform -translate-y-1/2 pointer-events-none"
            aria-hidden="true"
          >
            <component
              :is="sortIcon"
              :class="['w-4 h-4 transition-all duration-300', sortIconColor]"
              title="–ò–∫–æ–Ω–∫–∞ —Ç–µ–∫—É—â–µ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏"
              role="img"
              :aria-label="`–ò–∫–æ–Ω–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏: ${getSortIconDescription(
                sortBy
              )}`"
            />
          </div>

          <!-- –°—Ç—Ä–µ–ª–∫–∞ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ —Å Heroicons -->
          <div
            class="absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none"
            aria-hidden="true"
          >
            <ChevronDownIcon
              class="w-4 h-4 text-gray-400"
              role="img"
              aria-label="–°—Ç—Ä–µ–ª–∫–∞ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è —Å–ø–∏—Å–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏"
            />
          </div>

          <!-- –°–∫—Ä—ã—Ç–∞—è Schema.org –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ -->
          <meta itemprop="actionStatus" content="PotentialActionStatus" />
          <meta itemprop="object" :content="categoryTitle" />
        </div>
      </nav>
    </section>
  </header>
</template>

<script setup>
import { ref, computed, onMounted, onUnmounted, nextTick } from "vue";
import { useHead, useRoute } from "#app";
// –ò–º–ø–æ—Ä—Ç –∏–∫–æ–Ω–æ–∫ Heroicons –≤ –µ–¥–∏–Ω–æ–º —Å—Ç–∏–ª–µ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
import {
  Squares2X2Icon,
  ViewColumnsIcon,
  ChevronDownIcon,
  // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∫–æ–Ω–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
  FireIcon, // –î–ª—è –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ - –∫–∞–∫ –æ–≥–æ–Ω—å –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏
  ArrowUpIcon, // –î–ª—è —Ü–µ–Ω—ã –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é
  ArrowDownIcon, // –î–ª—è —Ü–µ–Ω—ã –ø–æ —É–±—ã–≤–∞–Ω–∏—é
  StarIcon, // –î–ª—è —Ä–µ–π—Ç–∏–Ω–≥–∞ - –∑–≤–µ–∑–¥–æ—á–∫–∞ –æ—Ü–µ–Ω–∫–∏
  SparklesIcon, // –î–ª—è –Ω–æ–≤–∏–Ω–æ–∫ - –∏—Å–∫–æ—Ä–∫–∏ –Ω–æ–≤–∏–∑–Ω—ã
  CurrencyDollarIcon, // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–∫–æ–Ω–∫–∞ –¥–ª—è —Ü–µ–Ω—ã
} from "@heroicons/vue/24/solid";

// üìã –ü—Ä–æ–ø—Å—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
const props = defineProps({
  categoryTitle: {
    type: String,
    required: true,
  },
  totalCount: {
    type: Number,
    default: 0,
  },
  viewMode: {
    type: Number,
    default: 4,
    validator: (value) => [3, 4].includes(value),
  },
  sortBy: {
    type: String,
    default: "popularity",
  },
  isLoading: {
    type: Boolean,
    default: false,
  },
});

// üéØ –°–æ–±—ã—Ç–∏—è
const emit = defineEmits(["changeViewMode", "changeSorting"]);

// üìä –°—Å—ã–ª–∫–∏ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º
const headerRef = ref(null);
const viewToggleRef = ref(null);
const sortRef = ref(null);

// –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π –º–∞—Ä—à—Ä—É—Ç –≤ setup –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
const route = useRoute();

// üî§ –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Å–∫–ª–æ–Ω–µ–Ω–∏—è —Å–ª–æ–≤–∞ "—Ç–æ–≤–∞—Ä"
const getProductsWord = (count) => {
  const lastDigit = count % 10;
  const lastTwoDigits = count % 100;

  if (lastTwoDigits >= 11 && lastTwoDigits <= 19) {
    return "—Ç–æ–≤–∞—Ä–æ–≤";
  }

  switch (lastDigit) {
    case 1:
      return "—Ç–æ–≤–∞—Ä";
    case 2:
    case 3:
    case 4:
      return "—Ç–æ–≤–∞—Ä–∞";
    default:
      return "—Ç–æ–≤–∞—Ä–æ–≤";
  }
};

/**
 * Computed —Å–≤–æ–π—Å—Ç–≤–æ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–∫–æ–Ω–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
 * –ö–∞–∫ –≤ Tinder - –∫–∞–∂–¥—ã–π —Ç–∏–ø –∏–º–µ–µ—Ç —Å–≤–æ—é —É–Ω–∏–∫–∞–ª—å–Ω—É—é –∏–∫–æ–Ω–∫—É
 */
const sortIcon = computed(() => {
  switch (props.sortBy) {
    case "popularity":
      return FireIcon; // –û–≥–æ–Ω—å –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏
    case "price-asc":
      return ArrowUpIcon; // –°—Ç—Ä–µ–ª–∫–∞ –≤–≤–µ—Ä—Ö –¥–ª—è –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è —Ü–µ–Ω—ã
    case "price-desc":
      return ArrowDownIcon; // –°—Ç—Ä–µ–ª–∫–∞ –≤–Ω–∏–∑ –¥–ª—è —É–±—ã–≤–∞–Ω–∏—è —Ü–µ–Ω—ã
    case "rating":
      return StarIcon; // –ó–≤–µ–∑–¥–∞ –¥–ª—è —Ä–µ–π—Ç–∏–Ω–≥–∞
    case "newest":
      return SparklesIcon; // –ò—Å–∫–æ—Ä–∫–∏ –¥–ª—è –Ω–æ–≤–∏–Ω–æ–∫
    default:
      return FireIcon; // –î–µ—Ñ–æ–ª—Ç–Ω–∞—è –∏–∫–æ–Ω–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
  }
});

/**
 * Computed —Å–≤–æ–π—Å—Ç–≤–æ –¥–ª—è —Ü–≤–µ—Ç–∞ –∏–∫–æ–Ω–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
 * –ö–∞–∂–¥—ã–π —Ç–∏–ø —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏–º–µ–µ—Ç —Å–≤–æ–π —Ñ–∏—Ä–º–µ–Ω–Ω—ã–π —Ü–≤–µ—Ç
 */
const sortIconColor = computed(() => {
  switch (props.sortBy) {
    case "popularity":
      return "text-orange-500"; // –û—Ä–∞–Ω–∂–µ–≤—ã–π –æ–≥–æ–Ω—å –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏
    case "price-asc":
      return "text-green-500"; // –ó–µ–ª–µ–Ω—ã–π –¥–ª—è —Ä–æ—Å—Ç–∞ —Ü–µ–Ω—ã
    case "price-desc":
      return "text-red-500"; // –ö—Ä–∞—Å–Ω—ã–π –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã
    case "rating":
      return "text-yellow-500"; // –ñ–µ–ª—Ç—ã–π –¥–ª—è –∑–≤–µ–∑–¥—ã —Ä–µ–π—Ç–∏–Ω–≥–∞
    case "newest":
      return "text-purple-500"; // –§–∏–æ–ª–µ—Ç–æ–≤—ã–π –¥–ª—è –Ω–æ–≤–∏–Ω–æ–∫
    default:
      return "text-gray-400"; // –°–µ—Ä—ã–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  }
});

/**
 * –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –∏–∫–æ–Ω–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –¥–ª—è screen readers
 * –î–µ–ª–∞–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ—Å—Ç—É–ø–Ω—ã–º –¥–ª—è –ª—é–¥–µ–π —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏
 */
const getSortIconDescription = (sortType) => {
  switch (sortType) {
    case "popularity":
      return "–æ–≥–æ–Ω—å –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏";
    case "price-asc":
      return "—Å—Ç—Ä–µ–ª–∫–∞ –≤–≤–µ—Ä—Ö, —Ü–µ–Ω–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é";
    case "price-desc":
      return "—Å—Ç—Ä–µ–ª–∫–∞ –≤–Ω–∏–∑, —Ü–µ–Ω–∞ –ø–æ —É–±—ã–≤–∞–Ω–∏—é";
    case "rating":
      return "–∑–≤–µ–∑–¥–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞";
    case "newest":
      return "–∏—Å–∫–æ—Ä–∫–∏ –Ω–æ–≤–∏–Ω–æ–∫";
    default:
      return "–∏–∫–æ–Ω–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏";
  }
};

// üéØ SEO –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º
useHead({
  title: computed(() => `${props.categoryTitle} - Pink Rabbit`),
  meta: [
    {
      name: "description",
      content: computed(
        () =>
          `–ö–∞—Ç–∞–ª–æ–≥ ${props.categoryTitle.toLowerCase()} —Å —Å–∏—Å—Ç–µ–º–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏. –ù–∞–π–¥–µ–Ω–æ ${
            props.totalCount
          } —Ç–æ–≤–∞—Ä–æ–≤.`
      ),
    },
    {
      property: "og:title",
      content: computed(() => `${props.categoryTitle} - Pink Rabbit`),
    },
    {
      property: "og:description",
      content: computed(
        () =>
          `–ö–∞—Ç–∞–ª–æ–≥ ${props.categoryTitle.toLowerCase()} —Å —Å–∏—Å—Ç–µ–º–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏`
      ),
    },
  ],
  script: [
    {
      type: "application/ld+json",
      children: computed(() =>
        JSON.stringify({
          "@context": "https://schema.org",
          "@type": "BreadcrumbList",
          itemListElement: [
            {
              "@type": "ListItem",
              position: 1,
              name: "–ì–ª–∞–≤–Ω–∞—è",
              item: "https://pink-rabbit.ru",
            },
            {
              "@type": "ListItem",
              position: 2,
              name: props.categoryTitle,
              item: `https://pink-rabbit.ru${route.path}`,
            },
          ],
        })
      ),
    },
    {
      type: "application/ld+json",
      children: computed(() =>
        JSON.stringify({
          "@context": "https://schema.org",
          "@type": "CollectionPage",
          name: props.categoryTitle,
          description: `–ö–∞—Ç–∞–ª–æ–≥ ${props.categoryTitle.toLowerCase()} —Å —Å–∏—Å—Ç–µ–º–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏`,
          numberOfItems: props.totalCount,
          isPartOf: {
            "@type": "WebSite",
            name: "Pink Rabbit",
            url: "https://pink-rabbit.ru",
          },
          offers: {
            "@type": "AggregateOffer",
            priceCurrency: "RUB",
            lowPrice: "500",
            highPrice: "250000",
            offerCount: props.totalCount,
          },
        })
      ),
    },
  ],
});

// –≠–∫—Å–ø–æ—Ä—Ç —Å—Å—ã–ª–æ–∫ –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º
defineExpose({
  headerRef,
  viewToggleRef,
  sortRef,
});
</script>

<style scoped>
/* === –ê–ù–ò–ú–ê–¶–ò–ò –°–ö–ï–õ–ï–¢–û–ù–ê === */
@keyframes pinkRabbitShimmer {
  0% {
    background-position: -200px 0;
    opacity: 0.5;
  }
  50% {
    background-position: calc(100px + 50%) 0;
    opacity: 1;
  }
  100% {
    background-position: calc(200px + 100%) 0;
    opacity: 0.5;
  }
}

/* === üéØ –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò –ó–ê–ì–û–õ–û–í–ö–ê –ö–ê–¢–ê–õ–û–ì–ê === */
.catalog-header {
  @apply bg-white border-b border-gray-200 p-4 rounded-lg shadow-sm;
  /* –î–æ–±–∞–≤–ª—è–µ–º sticky –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∫–∞–∫ –≤ AdultToysFilters */
  position: sticky;
  top: 1rem;
  z-index: 20;
  backdrop-filter: blur(10px);
  background: linear-gradient(
    135deg,
    rgba(255, 255, 255, 0.98),
    rgba(248, 250, 252, 0.98)
  );
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  border-radius: 0 0 12px 12px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

/* –≠—Ñ—Ñ–µ–∫—Ç –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ - —É—Å–∏–ª–∏–≤–∞–µ–º —Ç–µ–Ω—å */
.catalog-header-sticky {
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  border-bottom: 1px solid rgba(236, 72, 153, 0.1);
}

.catalog-header:hover {
  box-shadow: 0 6px 25px rgba(236, 72, 153, 0.08);
  border-color: rgba(236, 72, 153, 0.15);
  transform: translateY(-1px);
}

/* –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –ª–∏–Ω–∏—è —Å–≤–µ—Ä—Ö—É –ø—Ä–∏ sticky —Å–æ—Å—Ç–æ—è–Ω–∏–∏ */
.catalog-header-sticky::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(
    90deg,
    transparent,
    rgba(236, 72, 153, 0.3),
    transparent
  );
}

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ */
.catalog-title {
  background: linear-gradient(
    45deg,
    #ff6b9d,
    #ff8fb3,
    #8b5cf6,
    #06b6d4,
    #10b981,
    #f59e0b,
    #ef4444,
    #ff6b9d
  );
  background-size: 300% 300%;
  background-clip: text;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  font-weight: 700;
  letter-spacing: -0.025em;
  animation: gradientShift 4s ease-in-out infinite,
    textGlow 2s ease-in-out infinite alternate;
  position: relative;
  text-shadow: 0 0 10px rgba(255, 107, 157, 0.3);
}

/* –°—á–µ—Ç—á–∏–∫ —Ç–æ–≤–∞—Ä–æ–≤ */
.catalog-count {
  background: linear-gradient(135deg, #6b7280, #9ca3af, #6b7280);
  background-size: 200% 200%;
  background-clip: text;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  font-size: 0.875rem;
  font-weight: 500;
  animation: subtleGradient 3s ease-in-out infinite;
  opacity: 0.8;
  transition: opacity 0.3s ease;
}

.catalog-count:hover {
  opacity: 1;
}

/* –¢–æ–Ω–∫–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –¥–ª—è —Å—á–µ—Ç—á–∏–∫–∞ */
@keyframes subtleGradient {
  0%,
  100% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
}

/* –£–ª—É—á—à–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞—Ç–∞–ª–æ–≥–µ */
.catalog-info {
  position: relative;
  padding: 0.5rem 0;
}

.catalog-info::before {
  content: "";
  position: absolute;
  top: 0;
  left: -10px;
  width: 4px;
  height: 100%;
  background: linear-gradient(to bottom, #ff6b9d, #8b5cf6, #06b6d4);
  border-radius: 2px;
  animation: barGlow 2s ease-in-out infinite alternate;
}

/* –ê–Ω–∏–º–∞—Ü–∏—è —Å–≤–µ—Ç–æ–≤–æ–π –ø–æ–ª–æ—Å—ã */
@keyframes barGlow {
  0% {
    opacity: 0.6;
    transform: scaleY(0.8);
  }
  100% {
    opacity: 1;
    transform: scaleY(1);
  }
}

/* –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
.catalog-controls {
  gap: 1rem;
}

/* –ö–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–æ–≤ */
.view-toggle-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  border-radius: 8px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.view-toggle-button::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(
    45deg,
    transparent,
    rgba(255, 107, 157, 0.1),
    transparent
  );
  transform: translateX(-100%);
  transition: transform 0.5s ease;
}

.view-toggle-button:hover::before {
  transform: translateX(100%);
}

.view-toggle-button:hover {
  transform: scale(1.05);
  background: rgba(255, 107, 157, 0.1);
}

.view-active {
  background: linear-gradient(135deg, #ff6b9d, #ff8fb3) !important;
  color: white !important;
  box-shadow: 0 4px 12px rgba(255, 107, 157, 0.3);
  transform: scale(1.05);
  animation: activeGlow 2s ease-in-out infinite alternate;
}

@keyframes activeGlow {
  0% {
    box-shadow: 0 4px 12px rgba(255, 107, 157, 0.3);
  }
  100% {
    box-shadow: 0 6px 20px rgba(255, 107, 157, 0.5);
  }
}

.view-active .w-5 {
  animation: iconPulse 2s ease-in-out infinite alternate;
}

@keyframes iconPulse {
  0% {
    transform: scale(1);
    filter: drop-shadow(0 2px 4px rgba(255, 255, 255, 0.3));
  }
  100% {
    transform: scale(1.05);
    filter: drop-shadow(0 4px 8px rgba(255, 255, 255, 0.5));
  }
}

/* –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ */
.sort-wrapper {
  position: relative;
  min-width: 200px;
}

/* –°–µ–ª–µ–∫—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ */
.sort-select {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  transition: all 0.3s ease;
  padding-right: 2.5rem;
  cursor: pointer;
  width: 100%;
}

.sort-select:hover {
  background: rgba(255, 255, 255, 1);
  border-color: #ff6b9d;
}

.sort-select:focus {
  transform: scale(1.02);
  box-shadow: 0 0 0 3px rgba(255, 107, 157, 0.1);
  border-color: #ff6b9d;
  outline: none;
}

.sort-select:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –∏–∫–æ–Ω–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ */
.sort-wrapper .w-4 {
  transition: all 0.3s ease;
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –∏–∫–æ–Ω–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ */
.sort-wrapper [title="–ò–∫–æ–Ω–∫–∞ —Ç–µ–∫—É—â–µ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏"] {
  animation: sortIconActive 2s ease-in-out infinite alternate;
}

@keyframes sortIconActive {
  0% {
    transform: scale(1) rotate(0deg);
    filter: drop-shadow(0 0 2px currentColor);
  }
  100% {
    transform: scale(1.1) rotate(2deg);
    filter: drop-shadow(0 0 6px currentColor);
  }
}

/* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ */
.text-orange-500 {
  animation: fireGlow 1.5s ease-in-out infinite alternate;
}

.text-green-500 {
  animation: upArrowGlow 2s ease-in-out infinite;
}

.text-red-500 {
  animation: downArrowGlow 2s ease-in-out infinite;
}

.text-yellow-500 {
  animation: starTwinkle 1.8s ease-in-out infinite;
}

.text-purple-500 {
  animation: sparkleShimmer 2.2s ease-in-out infinite;
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –æ–≥–Ω—è –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ */
@keyframes fireGlow {
  0% {
    filter: drop-shadow(0 0 3px #f97316) brightness(1);
  }
  100% {
    filter: drop-shadow(0 0 8px #f97316) brightness(1.2);
  }
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è —Å—Ç—Ä–µ–ª–∫–∏ –≤–≤–µ—Ä—Ö */
@keyframes upArrowGlow {
  0%,
  100% {
    transform: translateY(0);
    filter: drop-shadow(0 0 2px #10b981);
  }
  50% {
    transform: translateY(-2px);
    filter: drop-shadow(0 0 6px #10b981);
  }
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è —Å—Ç—Ä–µ–ª–∫–∏ –≤–Ω–∏–∑ */
@keyframes downArrowGlow {
  0%,
  100% {
    transform: translateY(0);
    filter: drop-shadow(0 0 2px #ef4444);
  }
  50% {
    transform: translateY(2px);
    filter: drop-shadow(0 0 6px #ef4444);
  }
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –º–µ—Ä—Ü–∞–Ω–∏—è –∑–≤–µ–∑–¥—ã */
@keyframes starTwinkle {
  0%,
  100% {
    transform: scale(1) rotate(0deg);
    filter: drop-shadow(0 0 3px #eab308) brightness(1);
  }
  25% {
    transform: scale(1.1) rotate(18deg);
    filter: drop-shadow(0 0 6px #eab308) brightness(1.3);
  }
  75% {
    transform: scale(1.05) rotate(-18deg);
    filter: drop-shadow(0 0 4px #eab308) brightness(1.1);
  }
}

.sort-select:focus + div .w-4,
.sort-select:hover + div .w-4 {
  transform: scale(1.2);
  filter: brightness(1.3) !important;
}

.sort-select:focus ~ div .w-4 {
  animation-duration: 1s !important;
}

/* –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ü–≤–µ—Ç–∞ –¥–ª—è —Ñ–æ–∫—É—Å–∞ */
.focus\:ring-custom-pink:focus {
  --tw-ring-color: rgba(255, 107, 157, 0.5);
}

.focus\:border-custom-pink:focus {
  border-color: #ff6b9d;
}

/* –ê–Ω–∏–º–∞—Ü–∏—è skeleton */
@keyframes pulse {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

.animate-pulse {
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
@media (max-width: 640px) {
  .catalog-controls {
    flex-direction: column;
    align-items: stretch;
    gap: 0.75rem;
  }

  .sort-wrapper {
    min-width: auto;
  }

  .catalog-title {
    font-size: 1.5rem;
  }
}

@media (max-width: 480px) {
  .catalog-header {
    padding: 1rem;
  }

  .view-toggle-button {
    width: 36px;
    height: 36px;
  }

  .sort-select {
    font-size: 0.875rem;
    padding: 0.5rem 2rem 0.5rem 2.5rem;
  }
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ */
@keyframes gradientShift {
  0% {
    background-position: 0% 50%;
  }
  25% {
    background-position: 100% 50%;
  }
  50% {
    background-position: 100% 100%;
  }
  75% {
    background-position: 0% 100%;
  }
  100% {
    background-position: 0% 50%;
  }
}

/* –ê–Ω–∏–º–∞—Ü–∏—è —Å–≤–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ */
@keyframes textGlow {
  0% {
    filter: brightness(1) contrast(1);
    transform: scale(1);
  }
  100% {
    filter: brightness(1.2) contrast(1.1);
    transform: scale(1.02);
  }
}

/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –ø–µ—Ä–µ–ª–∏–≤–∞–Ω–∏—è –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ */
.catalog-title::before {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(
    90deg,
    transparent,
    rgba(255, 255, 255, 0.4),
    transparent
  );
  animation: shimmer 3s ease-in-out infinite;
  z-index: 1;
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –±–ª–∏–∫–∞ */
@keyframes shimmer {
  0% {
    left: -100%;
  }
  50% {
    left: 100%;
  }
  100% {
    left: 100%;
  }
}

/* –ê–Ω–∏–º–∞—Ü–∏–∏ –∏ —Å—Ç–∏–ª–∏ –¥–ª—è –∏–∫–æ–Ω–æ–∫ */
.view-toggle-button .w-5 {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.view-toggle-button:hover .w-5 {
  transform: scale(1.1);
  filter: drop-shadow(0 2px 4px rgba(255, 107, 157, 0.3));
}

/* === SKELETON –°–¢–ò–õ–ò === */
.pink-rabbit-header-skeleton {
  @apply flex justify-between items-center p-4 mb-6 bg-white rounded-xl shadow-sm border border-gray-100;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.pink-rabbit-header-skeleton:hover {
  box-shadow: 0 10px 25px rgba(236, 72, 153, 0.1);
  border-color: rgba(236, 72, 153, 0.2);
}

.skeleton-content {
  @apply flex items-center gap-4;
}

.skeleton-title {
  width: 200px;
  height: 28px;
  background: linear-gradient(
    90deg,
    rgba(236, 72, 153, 0.08) 0%,
    rgba(236, 72, 153, 0.25) 50%,
    rgba(236, 72, 153, 0.08) 100%
  );
  background-size: 200% 100%;
  border-radius: 14px;
  animation: pinkRabbitShimmer 3.5s cubic-bezier(0.4, 0, 0.2, 1) infinite;
  animation-delay: 0.2s;
}

.skeleton-counter {
  width: 80px;
  height: 20px;
  background: linear-gradient(
    90deg,
    rgba(236, 72, 153, 0.05) 0%,
    rgba(236, 72, 153, 0.15) 50%,
    rgba(236, 72, 153, 0.05) 100%
  );
  background-size: 200% 100%;
  border-radius: 10px;
  animation: pinkRabbitShimmer 3.5s cubic-bezier(0.4, 0, 0.2, 1) infinite;
  animation-delay: 0.4s;
}

.skeleton-controls {
  @apply flex items-center gap-3;
}

.skeleton-view-toggle {
  @apply flex gap-2;
}

.skeleton-view-btn {
  width: 40px;
  height: 40px;
  background: linear-gradient(
    90deg,
    rgba(236, 72, 153, 0.08) 0%,
    rgba(236, 72, 153, 0.2) 50%,
    rgba(236, 72, 153, 0.08) 100%
  );
  background-size: 200% 100%;
  border-radius: 10px;
  animation: pinkRabbitShimmer 3.5s cubic-bezier(0.4, 0, 0.2, 1) infinite;
}

.skeleton-view-btn:nth-child(1) {
  animation-delay: 0.6s;
}

.skeleton-view-btn:nth-child(2) {
  animation-delay: 0.8s;
}

.skeleton-sort-dropdown {
  width: 160px;
  height: 40px;
  background: linear-gradient(
    90deg,
    rgba(236, 72, 153, 0.08) 0%,
    rgba(236, 72, 153, 0.2) 50%,
    rgba(236, 72, 153, 0.08) 100%
  );
  background-size: 200% 100%;
  border-radius: 10px;
  animation: pinkRabbitShimmer 3.5s cubic-bezier(0.4, 0, 0.2, 1) infinite;
  animation-delay: 1s;
}
</style>
